<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-hpc/containers/singularity_with_conda" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Singularity with Conda | Research Technology Servcies</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/rts-docs-dev/pr-preview/pr-65/img/NYU.svg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/rts-docs-dev/pr-preview/pr-65/img/NYU.svg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/singularity_with_conda/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Singularity with Conda | Research Technology Servcies"><meta data-rh="true" name="description" content="What is Singularity?"><meta data-rh="true" property="og:description" content="What is Singularity?"><link data-rh="true" rel="icon" href="/rts-docs-dev/pr-preview/pr-65/img/NYU.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/singularity_with_conda/"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/singularity_with_conda/" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/singularity_with_conda/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rts-docs-dev/pr-preview/pr-65/blog/rss.xml" title="Research Technology Servcies RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rts-docs-dev/pr-preview/pr-65/blog/atom.xml" title="Research Technology Servcies Atom Feed"><link rel="stylesheet" href="/rts-docs-dev/pr-preview/pr-65/assets/css/styles.41aa198f.css">
<script src="/rts-docs-dev/pr-preview/pr-65/assets/js/runtime~main.6bdf60cc.js" defer="defer"></script>
<script src="/rts-docs-dev/pr-preview/pr-65/assets/js/main.31ff0ac8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/rts-docs-dev/pr-preview/pr-65/img/NYU.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_o_05" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rts-docs-dev/pr-preview/pr-65/"><div class="navbar__logo"><img src="/rts-docs-dev/pr-preview/pr-65/img/NYU.svg" alt="My Site Logo" class="themedComponent_OSUF themedComponent--light_dfpo"><img src="/rts-docs-dev/pr-preview/pr-65/img/NYU.svg" alt="My Site Logo" class="themedComponent_OSUF themedComponent--dark_I239"></div><b class="navbar__title text--truncate">Research Technology Services</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/rts-docs-dev/pr-preview/pr-65/docs/genai/intro/">Pythia</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/getting_started/intro/">HPC</a><a class="navbar__item navbar__link" href="/rts-docs-dev/pr-preview/pr-65/docs/hsrn/intro/">HSRN</a><a class="navbar__item navbar__link" href="/rts-docs-dev/pr-preview/pr-65/docs/rtc/intro/">RTC</a><a class="navbar__item navbar__link" href="/rts-docs-dev/pr-preview/pr-65/docs/srde/getting_started/intro/">SRDE</a><a class="navbar__item navbar__link" href="/rts-docs-dev/pr-preview/pr-65/blog/">Announcements</a><div class="toggle_syyu colorModeToggle_mlkY"><button class="clean-btn toggleButton_kVtb toggleButtonDisabled_DmHv" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_xEJW"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_GWUJ"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_s8KS"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_BpjK"><div class="docsWrapper_ydao"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_PExZ" type="button"></button><div class="docRoot_vkIO"><aside class="theme-doc-sidebar-container docSidebarContainer_FZJl"><div class="sidebarViewport_Z8JJ"><div class="sidebar_g1hK"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_zqLk"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/getting_started/intro/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/connecting_to_hpc/connecting_to_hpc/">Setup</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/storage/intro/">Storage &amp; Data transfers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/datasets/intro/">datasets</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/submitting_jobs/slurm_submitting_jobs/">Submitting jobs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/tools_and_software/intro/">Tools &amp; Software available</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/intro/">Containers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/intro/">Apptainer/Singularity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/containers/">Using Containers on HPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/singularity_with_conda/">Singularity with Conda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/squash_file_system_and_singularity/">Squash File System and Singularity</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/ml_ai_hpc/intro/">ML/AI on HPC</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/ood/open_on_demand/">Open OnDemand</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/tutorials/linux_tutorial/">Tutorials from old website</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/training_and_support/training_at_nyu/">Training and Support</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/spec_sheet/">Greene Spec Sheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/system_status/">Greene System Status</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_cSyS"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_RKG7"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_Oi0z"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_SRrv"><div class="docItemContainer_HmLP"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_BhGi" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rts-docs-dev/pr-preview/pr-65/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_ciEK"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Containers</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Singularity with Conda</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_BxKV theme-doc-toc-mobile tocMobile_aQay"><button type="button" class="clean-btn tocCollapsibleButton_ZuIR">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Singularity with Conda</h1></header>
<h2 class="anchor anchorWithStickyNavbar_E4Aj" id="what-is-singularity">What is Singularity?<a href="#what-is-singularity" class="hash-link" aria-label="Direct link to What is Singularity?" title="Direct link to What is Singularity?">​</a></h2>
<p>Singularity is a free, cross-platform and open-source program that creates and executes containers on the HPC clusters. Containers are streamlined, virtualized environments for specific programs or packages. Singularity is an industry standard tool to utilize containers in HPC environments. Containers allow for the support of highly specific environments and further increase scientific reproducibility and portability. Using Singularity containers, researchers can work in the reproducible containerized environments of their choice can easily tailor them to their needs.</p>
<h2 class="anchor anchorWithStickyNavbar_E4Aj" id="using-singularity-overlays-for-miniforge-python--julia">Using Singularity Overlays for Miniforge (Python &amp; Julia)<a href="#using-singularity-overlays-for-miniforge-python--julia" class="hash-link" aria-label="Direct link to Using Singularity Overlays for Miniforge (Python &amp; Julia)" title="Direct link to Using Singularity Overlays for Miniforge (Python &amp; Julia)">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_E4Aj" id="preinstallation-warning">Preinstallation Warning<a href="#preinstallation-warning" class="hash-link" aria-label="Direct link to Preinstallation Warning" title="Direct link to Preinstallation Warning">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_mX7U alert alert--warning"><div class="admonitionHeading_wefB"><span class="admonitionIcon_Q6Gm"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_bUU3"><p>If you have initialized Conda in your base environment, your prompt on Greene may show something like:</p><div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">base</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">NETID@log-1 ~</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain">$</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>then you must first comment out or remove this portion of your <code>~/.bashrc</code> file:</p><div class="language-bash codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-bash codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># &gt;&gt;&gt; conda initialize &gt;&gt;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># !! Contents within this block are managed by &#x27;conda init&#x27; !!</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">__conda_setup</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">$(</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">&#x27;/share/apps/anaconda3/2020.07/bin/conda</span><span class="token string variable string" style="color:hsl(119, 34%, 47%)">&#x27; &#x27;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">shell.bash</span><span class="token string variable string" style="color:hsl(119, 34%, 47%)">&#x27; &#x27;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">hook&#x27; </span><span class="token string variable operator file-descriptor important" style="color:hsl(230, 8%, 24%);font-weight:bold">2</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)"> /dev/null</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">)</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> </span><span class="token variable" style="color:hsl(221, 87%, 60%)">$?</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-eq</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">eval</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">$__conda_setup</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;/share/apps/anaconda3/2020.07/etc/profile.d/conda.sh&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;/share/apps/anaconda3/2020.07/etc/profile.d/conda.sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:hsl(35, 99%, 36%)">PATH</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;/share/apps/anaconda3/2020.07/bin:</span><span class="token string environment constant" style="color:hsl(35, 99%, 36%)">$PATH</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">unset</span><span class="token plain"> __conda_setup</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># &lt;&lt;&lt; conda initialize &lt;&lt;&lt;</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above code automatically makes your environment look for the default shared installation of Conda on the cluster and will sabotage  any attempts to install packages to a Singularity environment. Once removed or commented out, log out and back into the cluster for a fresh environment.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_E4Aj" id="miniforge-environment-pytorch-example">Miniforge Environment PyTorch Example<a href="#miniforge-environment-pytorch-example" class="hash-link" aria-label="Direct link to Miniforge Environment PyTorch Example" title="Direct link to Miniforge Environment PyTorch Example">​</a></h3>
<p><a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html" target="_blank" rel="noopener noreferrer">Conda environments</a> allow users to create customizable, portable work environments and dependencies to support specific packages or versions of software for research. Common conda distributions include Anaconda, Miniconda and Miniforge. Packages are available via &quot;channels&quot;. Popular channels include &quot;conda-forge&quot; and &quot;bioconda&quot;.  In this tutorial we shall use <a href="https://github.com/conda-forge/miniforge" target="_blank" rel="noopener noreferrer">Miniforge</a> which sets &quot;conda-forge&quot; as the package channel. Traditional conda environments, however, also create a large number of files that can cut into quotas. To help reduce this issue, we suggest using <a href="https://docs.sylabs.io/guides/4.1/user-guide/" target="_blank" rel="noopener noreferrer">Singularity</a>, a container technology that is popular on HPC systems. Below is an example of how to create a pytorch environment using Singularity and Miniforge.</p>
<p>Create a directory for the environment</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">mkdir</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/pytorch-example</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/pytorch-example</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Copy an appropriate gzipped overlay images from the overlay directory. You can browse available images to see available options</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> /scratch/work/public/overlay-fs-ext3</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example we use overlay-15GB-500K.ext3.gz as it has enough available storage for most conda environments. It has 15GB free space inside and is able to hold 500K files
You can use another size as needed.</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">cp</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-rp</span><span class="token plain"> /scratch/work/public/overlay-fs-ext3/overlay-15GB-500K.ext3.gz </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gunzip overlay-15GB-500K.ext3.gz</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Choose a corresponding Singularity image. For this example we will use the following image</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/scratch/work/public/singularity/cuda12.1.1-cudnn8.9.0-devel-ubuntu22.04.2.sif </span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For Singularity image available on nyu HPC greene,  please check the singularity images folder</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/scratch/work/public/singularity/</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For the most recent supported versions of PyTorch, please check the <a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener noreferrer">PyTorch website</a>.</p>
<p>Launch the appropriate Singularity container in read/write mode (with the <!-- -->:rw<!-- --> flag)</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> overlay-15GB-500K.ext3:rw /scratch/work/public/singularity/cuda12.1.1-cudnn8.9.0-devel-ubuntu22.04.2.sif /bin/bash</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The above starts a bash shell inside the referenced Singularity Container overlayed with the 15GB 500K you set up earlier. This creates the functional illusion of having a writable filesystem inside the typically read-only Singularity container.</p>
<p>Now, inside the container, download and install miniforge to <code>/ext3/miniforge3</code></p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">wget</span><span class="token plain"> --no-check-certificate https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-Linux-x86_64.sh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">bash</span><span class="token plain"> Miniforge3-Linux-x86_64.sh </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-b</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> /ext3/miniforge3</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># rm Miniforge3-Linux-x86_64.sh # if you don&#x27;t need this file any longer</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next, create a wrapper script /ext3/env.sh using a text editor, like nano.</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">touch</span><span class="token plain"> /ext3/env.sh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">nano</span><span class="token plain"> /ext3/env.sh</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The wrapper script will activate your conda environment, to which you will be installing your packages and dependencies. The script should contain the following:</p>
<div class="language-bash codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-bash codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token shebang important" style="color:hsl(230, 8%, 24%);font-weight:bold">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">unset</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">which</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> /ext3/miniforge3/etc/profile.d/conda.sh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:hsl(35, 99%, 36%)">PATH</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">/ext3/miniforge3/bin:</span><span class="token environment constant" style="color:hsl(35, 99%, 36%)">$PATH</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">PYTHONPATH</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">/ext3/miniforge3/bin:</span><span class="token environment constant" style="color:hsl(35, 99%, 36%)">$PATH</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Activate your conda environment with the following:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> /ext3/env.sh</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you have the &quot;defaults&quot; channel enabled, please disable it with</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">conda config </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--remove</span><span class="token plain"> channels defaults</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now that your environment is activated, you can update and install packages:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">conda update </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-n</span><span class="token plain"> base conda </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-y</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">conda clean </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--all</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">conda </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> pip </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-y</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">conda </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> ipykernel </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-y</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Note: ipykernel is required to run as a kernel in the Open OnDemand Jupyter Notebooks</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To confirm that your environment is appropriately referencing your Miniforge installation, try out the following:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">unset</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">which</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">which</span><span class="token plain"> conda</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># output: /ext3/miniforge3/bin/conda</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">which</span><span class="token plain"> python</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># output: /ext3/miniforge3/bin/python</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">python </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># output: Python 3.8.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">which</span><span class="token plain"> pip</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># output: /ext3/miniforge3/bin/pip</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># exit Singularity</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_E4Aj" id="install-packages">Install packages<a href="#install-packages" class="hash-link" aria-label="Direct link to Install packages" title="Direct link to Install packages">​</a></h4>
<p>You may now install packages into the environment with either the pip install or conda install commands.</p>
<p>First, start an interactive job with adequate compute and memory resources to install packages. The login nodes restrict memory to 2GB per user, which may cause some large packages to crash.</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">srun --cpus-per-task</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--mem</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">10GB </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--time</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">04:00:00 </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--pty</span><span class="token plain"> /bin/bash</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># wait to be assigned a node</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> overlay-15GB-500K.ext3:rw /scratch/work/public/singularity/cuda12.1.1-cudnn8.9.0-devel-ubuntu22.04.2.sif /bin/bash</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> /ext3/env.sh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># activate the environment</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After it is running, you’ll be redirected to a compute node. From there, run singularity to setup on conda environment, same as you were doing on login node.</p>
<p>We will install PyTorch as an example:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pip3 </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> torch torchvision torchaudio --extra-index-url https://download.pytorch.org/whl/cu116</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pip3 </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> jupyter jupyterhub pandas matplotlib scipy scikit-learn scikit-image Pillow</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For the latest versions of PyTorch please check the <a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">PyTorch website</a>.</p>
<p>You can see the available space left on your image with the following commands:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">find</span><span class="token plain"> /ext3 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">wc</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-l</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># output: should be something like 45445</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">du</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-sh</span><span class="token plain">  /ext3        </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># output should be something like 4.9G    /ext3</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, exit the Singularity container and then rename the overlay image. Typing &#x27;exit&#x27; and hitting enter will exit the Singularity container if you are currently inside it. You can tell if you&#x27;re in a Singularity container because your prompt will be different, such as showing the prompt &#x27;Singularity&gt;&#x27;</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">mv</span><span class="token plain"> overlay-15GB-500K.ext3 my_pytorch.ext3</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_E4Aj" id="test-your-pytorch-singularity-image">Test your PyTorch Singularity Image<a href="#test-your-pytorch-singularity-image" class="hash-link" aria-label="Direct link to Test your PyTorch Singularity Image" title="Direct link to Test your PyTorch Singularity Image">​</a></h4>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/pytorch-example/my_pytorch.ext3:ro /scratch/work/public/singularity/cuda12.1.1-cudnn8.9.0-devel-ubuntu22.04.2.sif /bin/bash </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;source /ext3/env.sh; python -c &quot;import torch; print(torch.__file__); print(torch.__version__)&quot;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#output: /ext3/miniforge3/lib/python3.8/site-packages/torch/__init__.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#output: 1.8.0+cu111</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_mX7U alert alert--secondary"><div class="admonitionHeading_wefB"><span class="admonitionIcon_Q6Gm"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_bUU3"><p>the end &#x27;<!-- -->:ro<!-- -->&#x27; addition at the end of the pytorch ext3 image starts the image in read-only mode. To add packages you will need to use &#x27;<!-- -->:rw<!-- -->&#x27; to launch it in read-write mode.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_E4Aj" id="using-your-singularity-container-in-a-slurm-batch-job">Using your Singularity Container in a SLURM Batch Job<a href="#using-your-singularity-container-in-a-slurm-batch-job" class="hash-link" aria-label="Direct link to Using your Singularity Container in a SLURM Batch Job" title="Direct link to Using your Singularity Container in a SLURM Batch Job">​</a></h3>
<p>Below is an example script of how to call a python script, in this case torch-test.py, from a SLURM batch job using your new Singularity image</p>
<p>torch-test.py:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token shebang important" style="color:hsl(230, 8%, 24%);font-weight:bold">#!/bin/env python</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">import</span><span class="token plain"> torch</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">torch.__file__</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">torch.__version__</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># How many GPUs are there?</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">torch.cuda.device_count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Get the name of the current GPU</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">torch.cuda.get_device_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">torch.cuda.current_device</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">))</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Is PyTorch using a GPU?</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">print</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">torch.cuda.is_available</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">))</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we will write the SLURM job script, run-test.SBATCH, that will start our Singularity Image and call the torch-test.py script.</p>
<p>run-test.SBATCH:</p>
<div class="language-bash codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-bash codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token shebang important" style="color:hsl(230, 8%, 24%);font-weight:bold">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --nodes=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --ntasks-per-node=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --cpus-per-task=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --time=1:00:00</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --mem=2GB</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --gres=gpu</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --job-name=torch</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module purge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--nv</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	    </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/pytorch-example/my_pytorch.ext3:ro </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	    /scratch/work/public/singularity/cuda12.1.1-cudnn8.9.0-devel-ubuntu22.04.2.sif</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	    /bin/bash </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;source /ext3/env.sh; python torch-test.py&quot;</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You will notice that the singularity exec command features the &#x27;--nv flag&#x27; - this flag is reguired to pass the CUDA drivers from a GPU to the Singularity container.</p>
<p>Run the run-test.SBATCH script</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sbatch run-test.SBATCH</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Check your SLURM output for results, an example is shown below</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">cat</span><span class="token plain"> slurm-3752662.out</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># example output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># /ext3/miniforge3/lib/python3.8/site-packages/torch/__init__.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 1.8.0+cu111</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Quadro RTX 8000</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># True</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_E4Aj" id="optional-convert-ext3-to-a-compressed-read-only-squashfs-filesystem">Optional: Convert ext3 to a compressed, read-only squashfs filesystem<a href="#optional-convert-ext3-to-a-compressed-read-only-squashfs-filesystem" class="hash-link" aria-label="Direct link to Optional: Convert ext3 to a compressed, read-only squashfs filesystem" title="Direct link to Optional: Convert ext3 to a compressed, read-only squashfs filesystem">​</a></h3>
<p>Singularity images can be compressed into read-only squashfs filesystems to conserve space in your environment. Use the following steps to convert your ext3 Singularity image into a smaller squashfs filesystem.</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">srun </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-N1</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c4</span><span class="token plain"> singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> my_pytorch.ext3:ro /scratch/work/public/singularity/centos-8.2.2004.sif mksquashfs /ext3 /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/pytorch-example/my_pytorch.sqf -keep-as-directory </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-processors</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">4</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here is an example of the amount of compression that can be realized by converting:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-ltrsh</span><span class="token plain"> my_pytorch.*</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">5</span><span class="token plain">.5G -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> wang wang </span><span class="token number" style="color:hsl(35, 99%, 36%)">5</span><span class="token plain">.5G Mar </span><span class="token number" style="color:hsl(35, 99%, 36%)">14</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">20</span><span class="token plain">:45 my_pytorch.ext3</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">.2G -rw-r--r-- </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> wang wang </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">.2G Mar </span><span class="token number" style="color:hsl(35, 99%, 36%)">14</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">20</span><span class="token plain">:54 my_pytorch.sqf</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice that it saves over 3GB of storage in this case, though your results may vary.</p>
<h4 class="anchor anchorWithStickyNavbar_E4Aj" id="use-a-squashfs-image-for-running-jobs">Use a squashFS Image for Running Jobs<a href="#use-a-squashfs-image-for-running-jobs" class="hash-link" aria-label="Direct link to Use a squashFS Image for Running Jobs" title="Direct link to Use a squashFS Image for Running Jobs">​</a></h4>
<p>You can use squashFS images similarly to the ext3 images.</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/pytorch-example/my_pytorch.sqf:ro /scratch/work/public/singularity/cuda12.1.1-cudnn8.9.0-devel-ubuntu22.04.2.sif  /bin/bash </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;source /ext3/env.sh; python -c &quot;import torch; print(torch.__file__); print(torch.__version__)&quot;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#example output: /ext3/miniforge3/lib/python3.8/site-packages/torch/__init__.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#example output: 1.8.0+cu111</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_E4Aj" id="adding-packages-to-a-full-ext3-or-squashfs-image">Adding Packages to a Full ext3 or squashFS Image<a href="#adding-packages-to-a-full-ext3-or-squashfs-image" class="hash-link" aria-label="Direct link to Adding Packages to a Full ext3 or squashFS Image" title="Direct link to Adding Packages to a Full ext3 or squashFS Image">​</a></h4>
<p>If the first ext3 overlay image runs out of space or you are using a squashFS conda enviorment, but need to install a new package inside, please copy another writable ext3 overlay image to work together.</p>
<p>Open the first image in read only mode</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">cp</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-rp</span><span class="token plain"> /scratch/work/public/overlay-fs-ext3/overlay-2GB-100K.ext3.gz </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gunzip overlay-2GB-100K.ext3.gz</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> overlay-2GB-100K.ext3 </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/pytorch-example/my_pytorch.ext3:ro /scratch/work/public/singularity/cuda12.1.1-cudnn8.9.0-devel-ubuntu-22.04.2.sif </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/bin/bash</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> /ext3/env.sh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pip </span><span class="token function" style="color:hsl(221, 87%, 60%)">install</span><span class="token plain"> tensorboard</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_mX7U alert alert--secondary"><div class="admonitionHeading_wefB"><span class="admonitionIcon_Q6Gm"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_bUU3"><p><a href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/tools_and_software/conda_environments/">Click here</a> for information on how to configure your conda environment.</p></div></div>
<p>Please also keep in mind that once the overlay image is opened in default read-write mode, the file will be locked. You will not be able to open it from a new process. Once the overlay is opened either in read-write or read-only mode, it cannot be opened in RW mode from other processes either. For production jobs to run, the overlay image should be open in read-only mode. You can run many jobs at the same time as long as they are run in read-only mode. In this ways, it will protect the computation software environment, software packages are not allowed to change when there are jobs running.</p>
<h3 class="anchor anchorWithStickyNavbar_E4Aj" id="julia-singularity-image">Julia Singularity Image<a href="#julia-singularity-image" class="hash-link" aria-label="Direct link to Julia Singularity Image" title="Direct link to Julia Singularity Image">​</a></h3>
<p>Singularity can be used to set up a Julia environment.</p>
<p>Create a directory for your julia work, such as <code>/scratch/&lt;NetID&gt;/julia</code>, and then change to your home directory. An example is shown below.</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">mkdir</span><span class="token plain"> /home/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> /home/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Copy an overlay image, such as the 2GB 100K overlay, which generally has enough storage for Julia packages. Once copied, unzip to the same folder, rename to julia-pkgs.ext3</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">cp</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-rp</span><span class="token plain"> /scratch/work/public/overlay-fs-ext3/overlay-2GB-100K.ext3.gz </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gunzip overlay-2GB-100K.ext3.gz</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">mv</span><span class="token plain"> overlay-2GB-100K.ext3 julia-pkgs.ext3</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Copy the following wrapper script in the directory</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">cp</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-rp</span><span class="token plain"> /share/apps/utils/julia-setup/* </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now launch writable Singularity overlay to install packages</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module purge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module load knitro/12.3.0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module load julia/1.5.3</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">~/julia/my-julia-writable</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">using Pkg</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Pkg.add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;KNITRO&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Pkg.add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;JuMP&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now exit from the container to launch a read only version to test (example below)</p>
<div class="language-julia codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-julia codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token operator" style="color:hsl(221, 87%, 60%)">~</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">my</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">julia</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              _</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  _       _ _</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain">_     </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">  Documentation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token operator" style="color:hsl(221, 87%, 60%)">//</span><span class="token plain">docs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">julialang</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">org</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain">     </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain">    </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  _ _   _</span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">_  __ _   </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">  Type </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;?&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> help</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;]?&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> Pkg help</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> _` </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">_</span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">  Version </span><span class="token number" style="color:hsl(35, 99%, 36%)">1.5</span><span class="token number" style="color:hsl(35, 99%, 36%)">.3</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">2020</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">11</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">09</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">_</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token operator" style="color:hsl(221, 87%, 60%)">\</span><span class="token plain">__</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&#x27;</span><span class="token plain">_</span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">_</span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">_</span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token operator" style="color:hsl(221, 87%, 60%)">\</span><span class="token plain">__</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&#x27;</span><span class="token plain">_</span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">  Official https</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token operator" style="color:hsl(221, 87%, 60%)">//</span><span class="token plain">julialang</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">org</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> release</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain">__</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">                   </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">using</span><span class="token plain"> Pkg</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">using</span><span class="token plain"> JuMP</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> KNITRO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> m </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> Model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">with_optimizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">KNITRO</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Optimizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">A JuMP Model</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Feasibility problem with</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Variables</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Model mode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> AUTOMATIC</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">CachingOptimizer state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> EMPTY_OPTIMIZER</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Solver name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> Knitro</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> @variable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> @variable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x2 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> @NLconstraint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain">x2 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">x1 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain"> x2 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0.0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> @NLobjective</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> Min</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">x2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">^</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> optimize</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can make the above code into a julia script to test batch jobs. Save the following as test-knitro.jl</p>
<div class="language-julia codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-julia codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">using</span><span class="token plain"> Pkg</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">using</span><span class="token plain"> JuMP</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> KNITRO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">m </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> Model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">with_optimizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">KNITRO</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Optimizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@variable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@variable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x2 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@NLconstraint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain">x2 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@NLobjective</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> Min</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">x2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">^</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">optimize</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can add additional packages with commands like the one below.</p>
<div class="theme-admonition theme-admonition-note admonition_mX7U alert alert--secondary"><div class="admonitionHeading_wefB"><span class="admonitionIcon_Q6Gm"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_bUU3"><p>Please do not install new packages when you have Julia jobs running, this may create issues with your Julia installation)</p></div></div>
<div class="language-julia codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-julia codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token operator" style="color:hsl(221, 87%, 60%)">~</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">my</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">julia</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">writable </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">e </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&#x27;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">using</span><span class="token plain"> Pkg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> Pkg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;Calculus&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;LinearAlgebra&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&#x27;</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Run a SLURM job to test with the following sbatch command (e.g. julia-test.SBATCH)</p>
<div class="language-bash codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-bash codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token shebang important" style="color:hsl(230, 8%, 24%);font-weight:bold">#!/bin/bash </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --nodes=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --ntasks-per-node=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --cpus-per-task=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --time=1:00:00</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --mem=2GB</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --job-name=julia-test</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module purge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module load julia/1.5.3</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module load knitro/12.3.0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">~/julia/my-julia test-knitro.jl</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then run the command with the following:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sbatch julia-test.SBATCH</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once the job completes, check the SLURM output (example below)</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">cat</span><span class="token plain"> slurm-1022969.out</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">           Academic License</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">NOT FOR COMMERCIAL USE</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         Artelys Knitro </span><span class="token number" style="color:hsl(35, 99%, 36%)">12.3</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Knitro presolve eliminated </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> variables and </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> constraints.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">datacheck:               </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">hessian_no_f:            </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">par_numthreads:          </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Problem Characteristics                                 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">   Presolved</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">-----------------------</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Objective goal:  Minimize</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Objective type:  general</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Number of variables:                                  </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    bounded below only:                               </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    bounded above only:                               </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    bounded below and above:                          </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    fixed:                                            </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    free:                                             </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Number of constraints:                                </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    linear equalities:                                </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    quadratic equalities:                             </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    gen. nonlinear equalities:                        </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    linear one-sided inequalities:                    </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    quadratic one-sided inequalities:                 </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    gen. nonlinear one-sided inequalities:            </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    linear two-sided inequalities:                    </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    quadratic two-sided inequalities:                 </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    gen. nonlinear two-sided inequalities:            </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Number of nonzeros </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> Jacobian:                       </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Number of nonzeros </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> Hessian:                        </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">           </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Knitro using the Interior-Point/Barrier Direct algorithm.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  Iter      Objective      FeasError   OptError    </span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain">Step</span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain">    CGits </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">--------  --------------  ----------  ----------  ----------  -------</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">    </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">.000000e+00   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">.000e+00</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">WARNING: The initial point is a stationary point and only the first order</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         optimality conditions have been verified.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">EXIT: Locally optimal solution found.</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Final Statistics</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">----------------</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Final objective value               </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">.00000000000000e+00</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Final feasibility error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">abs / rel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">.00e+00 / </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">.00e+00</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Final optimality error  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">abs / rel</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">.00e+00 / </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">.00e+00</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># of iterations                     =          0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># of CG iterations                  =          0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># of function evaluations           =          1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># of gradient evaluations           =          1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># of Hessian evaluations            =          0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Total program </span><span class="token function" style="color:hsl(221, 87%, 60%)">time</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">secs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain">           </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">       </span><span class="token number" style="color:hsl(35, 99%, 36%)">1.03278</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">     </span><span class="token number" style="color:hsl(35, 99%, 36%)">1.014</span><span class="token plain"> CPU </span><span class="token function" style="color:hsl(221, 87%, 60%)">time</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Time spent </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> evaluations </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">secs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain">    </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">       </span><span class="token number" style="color:hsl(35, 99%, 36%)">0.00000</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_E4Aj" id="using-centos-8-for-julia-for-module-compatibility">Using CentOS 8 for Julia (for Module Compatibility)<a href="#using-centos-8-for-julia-for-module-compatibility" class="hash-link" aria-label="Direct link to Using CentOS 8 for Julia (for Module Compatibility)" title="Direct link to Using CentOS 8 for Julia (for Module Compatibility)">​</a></h3>
<p>Building on the previous Julia example, this will demonstrate how to set up a similar environment using the Singularity CentOS 8 image for additional customization. Using the CentOS 8 overlay allows for the loading of modules installed on Greene, such as Knitro 12.3.0</p>
<p>Copy overlay image</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">cp</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-rp</span><span class="token plain"> /scratch/work/public/overlay-fs-ext3/overlay-2GB-100K.ext3.gz </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">gunzip overlay-2GB-100K.ext3.gz</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">mv</span><span class="token plain"> overlay-2GB-100K.ext3 julia-pkgs.ext3</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The path in this example is <code>/scratch/&lt;NetID&gt;/julia/julia-pkgs.ext3</code></p>
<p>To use modules installed into <code>/share/apps</code> you can make two directories</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">mkdir</span><span class="token plain"> julia-compiled julia-logs</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, in this example, the absoulte paths are as follows</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-compiled</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-logs</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To launch Singularity with overlay images in writable mode to install packages</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-pkgs.ext3 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /share/apps </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-compiled:/ext3/pkgs/compiled </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-logs:/ext3/pkgs/logs  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /scratch/work/public/apps/greene/centos-8.2.2004.sif </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /bin/bash</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Implement a wrapper script /ext3/env.sh</p>
<div class="language-bash codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-bash codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">#/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">JULIA_DEPOT_PATH</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">/ext3/pkgs </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># this changes the default installation path to the environment</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> /opt/apps/lmod/lmod/init/bash</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module use /share/apps/modulefiles</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module purge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module load knitro/12.3.0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module load julia/1.5.3</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Load julia via the wrapper script and check that it loads properly</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">source</span><span class="token plain"> /ext3/env.sh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">which</span><span class="token plain"> julia</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># example output: /share/apps/julia/1.5.3/bin/julia</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># example output: julia version 1.5.3</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Run julia to install packages</p>
<div class="language-julia codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-julia codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">using</span><span class="token plain"> Pkg</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> Pkg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;KNITRO&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> Pkg</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;JuMP&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Set up a similar test script like the test-knitro.jl script above. Name it test.jl:</p>
<div class="language-julia codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-julia codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">using</span><span class="token plain"> Pkg</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">using</span><span class="token plain"> JuMP</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> KNITRO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">m </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> Model</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">with_optimizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">KNITRO</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Optimizer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@variable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@variable</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x2 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@NLconstraint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token plain">x2 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@NLobjective</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> Min</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">*</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">x2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">^</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">optimize</span><span class="token operator" style="color:hsl(221, 87%, 60%)">!</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now implement a wrapper script named julia into ~/bin, the overlay image is in readonly mode</p>
<div class="language-bash codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-bash codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token shebang important" style="color:hsl(230, 8%, 24%);font-weight:bold">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">args</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:hsl(221, 87%, 60%)">i</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">$@</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">i</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">${i</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">\\</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">\\\\}</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">args</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">$args</span><span class="token string" style="color:hsl(119, 34%, 47%)"> </span><span class="token string entity" style="color:hsl(230, 8%, 24%)">\&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">${i</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">\&quot;</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">\\\&quot;}</span><span class="token string entity" style="color:hsl(230, 8%, 24%)">\&quot;</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module purge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-pkgs.ext3:ro  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /share/apps </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-compiled:/ext3/pkgs/compiled </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-logs:/ext3/pkgs/logs  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /scratch/work/public/apps/greene/centos-8.2.2004.sif </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /bin/bash </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">source /ext3/env.sh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">julia </span><span class="token string variable" style="color:hsl(221, 87%, 60%)">$args</span><span class="token string" style="color:hsl(119, 34%, 47%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Make the wrapper executable</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">chmod</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">755</span><span class="token plain"> ~/bin/julia</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Test your installation with a SLURM job example. The following code has been put into a file called test-julia-centos.SBATCH</p>
<div class="language-bash codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-bash codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token shebang important" style="color:hsl(230, 8%, 24%);font-weight:bold">#!/bin/bash </span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --nodes=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --ntasks-per-node=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --cpus-per-task=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --time=1:00:00</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --mem=2GB</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#SBATCH --job-name=julia-test</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module purge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia test.jl</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Run the above with the following:</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">sbatch test-julia-centos.SBATCH</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Read the output (example below)</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">cat</span><span class="token plain"> slurm-764085.out </span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_E4Aj" id="installing-new-julia-packages-later">Installing New Julia Packages Later<a href="#installing-new-julia-packages-later" class="hash-link" aria-label="Direct link to Installing New Julia Packages Later" title="Direct link to Installing New Julia Packages Later">​</a></h4>
<p>Implement another writable julia-writable with overlay image writable in order to install new Julia packages later</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> /home/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/bin</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">cp</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-rp</span><span class="token plain"> julia julia-writable</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">args</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:hsl(221, 87%, 60%)">i</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">$@</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">i</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">${i</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">\\</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">\\\\}</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">args</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">$args</span><span class="token string" style="color:hsl(119, 34%, 47%)"> </span><span class="token string entity" style="color:hsl(230, 8%, 24%)">\&quot;</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">${i</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">\&quot;</span><span class="token string variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token string variable" style="color:hsl(221, 87%, 60%)">\\\&quot;}</span><span class="token string entity" style="color:hsl(230, 8%, 24%)">\&quot;</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module purge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">singularity </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">exec</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--overlay</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-pkgs.ext3  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /share/apps </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-compiled:/ext3/pkgs/compiled </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--bind</span><span class="token plain"> /scratch/</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">NetID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain">/julia/julia-logs:/ext3/pkgs/logs  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /scratch/work/public/apps/greene/centos-8.2.2004.sif </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /bin/bash </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">source /ext3/env.sh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">julia </span><span class="token string variable" style="color:hsl(221, 87%, 60%)">$args</span><span class="token string" style="color:hsl(119, 34%, 47%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Check the writable image</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">which</span><span class="token plain"> julia-writable</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">#example output: ~/bin/julia-writable</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Install packages to the writable image</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">julia-writable </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-e</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;using Pkg; Pkg.add([&quot;Calculus&quot;, &quot;LinearAlgebra&quot;])&#x27;</span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you do not need host packages installed in /share/apps, you can work with Singularity OS image</p>
<div class="language-sh codeBlockContainer_ZQnk theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_zrhV"><pre tabindex="0" class="prism-code language-sh codeBlock_C6Jp thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_kO0J"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/scratch/work/public/singularity/ubuntu-20.04.1.sif </span><br></span></code></pre><div class="buttonGroup_riju"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_qWLI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_ukjp"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VJGg"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>download Julia installation package from <a href="https://julialang-s3.julialang.org/bin/linux/x64/1.5/julia-1.5.3-linux-x86_64.tar.gz" target="_blank" rel="noopener noreferrer">https://julialang-s3.julialang.org/bin/linux/x64/1.5/julia-1.5.3-linux-x86_64.tar.gz</a></p>
<p>install Julia to <code>/ext3</code>, setup PATH properly. It will be easy to move to other servers in future.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/NYU-ITS/rts-docs-dev/blob/main/docs/hpc/07_containers/03_singularity_with_conda.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_CLA8" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_BsWH"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/containers/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Using Containers on HPC</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rts-docs-dev/pr-preview/pr-65/docs/hpc/containers/squash_file_system_and_singularity/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Squash File System and Singularity</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_eKKs thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-singularity" class="table-of-contents__link toc-highlight">What is Singularity?</a></li><li><a href="#using-singularity-overlays-for-miniforge-python--julia" class="table-of-contents__link toc-highlight">Using Singularity Overlays for Miniforge (Python &amp; Julia)</a><ul><li><a href="#preinstallation-warning" class="table-of-contents__link toc-highlight">Preinstallation Warning</a></li><li><a href="#miniforge-environment-pytorch-example" class="table-of-contents__link toc-highlight">Miniforge Environment PyTorch Example</a></li><li><a href="#using-your-singularity-container-in-a-slurm-batch-job" class="table-of-contents__link toc-highlight">Using your Singularity Container in a SLURM Batch Job</a></li><li><a href="#optional-convert-ext3-to-a-compressed-read-only-squashfs-filesystem" class="table-of-contents__link toc-highlight">Optional: Convert ext3 to a compressed, read-only squashfs filesystem</a></li><li><a href="#julia-singularity-image" class="table-of-contents__link toc-highlight">Julia Singularity Image</a></li><li><a href="#using-centos-8-for-julia-for-module-compatibility" class="table-of-contents__link toc-highlight">Using CentOS 8 for Julia (for Module Compatibility)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Feedback</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:hpc@nyu.edu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_jspQ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/rts-docs-dev/pr-preview/pr-65/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/NYU-ITS/rts-docs-dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_jspQ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Built with Docusaurus!</div></div></div></footer></div>
</body>
</html>