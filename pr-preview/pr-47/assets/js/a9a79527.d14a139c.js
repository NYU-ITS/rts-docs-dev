"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9930],{4553:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"srde/user_guide/getting_started","title":"SRDE User Guide","description":"Remote access to the secure environment workspace via the Command Line Interface. The SRDE consists of two separate servers:","source":"@site/docs/srde/02_user_guide/01_getting_started.mdx","sourceDirName":"srde/02_user_guide","slug":"/srde/user_guide/getting_started","permalink":"/rts-docs-dev/pr-preview/pr-47/docs/srde/user_guide/getting_started","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/srde/02_user_guide/01_getting_started.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"srdeSidebar","previous":{"title":"Secure Research Data Environment (SRDE)","permalink":"/rts-docs-dev/pr-preview/pr-47/docs/srde/getting_started/eligibility_accounts"},"next":{"title":"About SRDE & How to Get Started","permalink":"/rts-docs-dev/pr-preview/pr-47/docs/srde/faq/basics"}}');var o=n(6070),i=n(385);const r={},a="SRDE User Guide",c={},d=[{value:"Connecting through Google Cloud Console",id:"connecting-through-google-cloud-console",level:2},{value:"Connecting through Google Cloud Shell",id:"connecting-through-google-cloud-shell",level:2},{value:"Setting project and zone",id:"setting-project-and-zone",level:3},{value:"Confirm settings",id:"confirm-settings",level:3},{value:"Generate SSH keys",id:"generate-ssh-keys",level:3},{value:"Add SSH key to session",id:"add-ssh-key-to-session",level:3},{value:"Future logins",id:"future-logins",level:3}];function l(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"srde-user-guide",children:"SRDE User Guide"})}),"\n",(0,o.jsx)(s.p,{children:"Remote access to the secure environment workspace via the Command Line Interface. The SRDE consists of two separate servers:"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"The Workspace Host is where you access and analyze data"}),"\n",(0,o.jsx)(s.li,{children:"The Bastion Host acts as a proxy that allows your laptop/workstation to connect securely via the internet to the Workspace Host."}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["Accessing the Secure environment Workspace Host remotely via the Command Line Interface (CLI) is a two-step process: First you must connect to the Bastion Host and then from the Bastion Host access your Workspace Host.  The two-step process is demonstrated below:\n",(0,o.jsx)(s.img,{alt:"Virtual Private Network",src:n(3090).A+"",width:"1999",height:"742"})]}),"\n",(0,o.jsxs)(s.p,{children:["This two-step process is enabled with the use of SSH keys and SSH Agent Forwarding and is described in detail for some of the common Operating Systems (MacOS/Linux and Windows)  in the following sections of the User Guide. For more general information about using SSH keys and the use of Bastion Host ",(0,o.jsx)(s.a,{href:"https://medium.com/devops-dudes/setting-up-an-ssh-agent-to-access-the-bastion-in-vpc-532918577949",children:"see here"}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["User access to the secure environment is controlled by ",(0,o.jsx)(s.a,{href:"https://cloud.google.com/security/products/iap?hl=en",children:"Identity-Aware Proxy (IAP)"})," Google Cloud service. IAP provides a central way of managing user access and enforcing access control policies, without requiring external/public IP addresses on the Bastion Host and the Workspace Host."]}),"\n",(0,o.jsxs)(s.admonition,{title:"[Prerequisites]",type:"tip",children:[(0,o.jsx)(s.p,{children:"In order to be able to access your Secure Environment Workspace Host, you will need the following information, provided by the Secure Research Data Admins:"}),(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Project Id"})," for the Bastion Host (ex. test-dev1-bastion-1234)"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Zone Name"})," (ex. us-east4-a)"]}),"\n"]}),(0,o.jsx)(s.admonition,{type:"note",children:(0,o.jsx)(s.p,{children:"At this time you are not required to be on the NYU Network (or VPN into the NYU Network) in order to access the Secure Environment workspace."})})]}),"\n",(0,o.jsx)(s.h2,{id:"connecting-through-google-cloud-console",children:"Connecting through Google Cloud Console"}),"\n",(0,o.jsxs)(s.p,{children:["Navigate to Google Cloud Console ",(0,o.jsx)(s.a,{href:"https://console.cloud.google.com/welcome",children:"https://console.cloud.google.com/welcome"})," and login with your NetID. Click the Select a project drop-down list at the top left corner of the page. In the Select a project window that appears, search and select the bastion project using the provided project ID (ex. test-dev1-bastion-1234)."]}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.img,{alt:"Select a project",src:n(7685).A+"",width:"752",height:"132"})}),"\n",(0,o.jsx)(s.p,{children:"Once selected, navigate to the VM Instances page via the Navigation menu (Menu in the top left corner of the page ) > Compute Engine > VM Instances. A running Bastion instance will be visible in the page as shown below:"}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.img,{alt:"Bastion Instance",src:n(2077).A+"",width:"1999",height:"398"})}),"\n",(0,o.jsx)(s.p,{children:"ssh to the Bastion instance by clicking on the SSH button, a new SSH-in-browser tab will appear with a restricted CLI ( Command line interface ) connected to the instance. We are now inside the Bastion Host."}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.img,{alt:"SSH in browser",src:n(3190).A+"",width:"1796",height:"668"})}),"\n",(0,o.jsxs)(s.p,{children:["Now we can ssh to our workspace host by using the workspace internal IP address ",(0,o.jsx)(s.code,{children:"10.0.0.2"}),":"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"ssh 10.0.0.2\n"})}),"\n",(0,o.jsx)(s.p,{children:"This will open the workspace CLI, with access to the workspace host having the computing needs to work on our data."}),"\n",(0,o.jsx)(s.h2,{id:"connecting-through-google-cloud-shell",children:"Connecting through Google Cloud Shell"}),"\n",(0,o.jsxs)(s.p,{children:["Navigate to ",(0,o.jsx)(s.a,{href:"https://shell.cloud.google.com/",children:"https://shell.cloud.google.com/"})," while logged in using your NetID."]}),"\n",(0,o.jsx)(s.h3,{id:"setting-project-and-zone",children:"Setting project and zone"}),"\n",(0,o.jsx)(s.p,{children:"Note - Ask your SRDE administrator for the appropriate GCP PROJECT_ID and ZONE_NAME. Replace the values in the two commands below and run them"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"gcloud config set project PROJECT_ID\ngcloud config set compute/zone ZONE_NAME\n"})}),"\n",(0,o.jsx)(s.h3,{id:"confirm-settings",children:"Confirm settings"}),"\n",(0,o.jsx)(s.p,{children:"Before proceeding, confirm that the project and zone match your GCP project ID and zone:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"gcloud config list\n\n\n[compute]\nregion = us-east4\nzone = us-east4-a\n[core]\naccount = netid@nyu.edu\ndisable_usage_reporting = False\nproject = test-dev1-bastion-1234\n\n\nYour active configuration is: [default]\n"})}),"\n",(0,o.jsx)(s.h3,{id:"generate-ssh-keys",children:"Generate SSH keys"}),"\n",(0,o.jsx)(s.admonition,{title:"[Unused keys expire!]",type:"tip",children:(0,o.jsx)(s.p,{children:"Google Cloud Shell will delete your files, including generated SSH keys, if they are not accessed for 120 days. If this happens you will need to generate them again."})}),"\n",(0,o.jsx)(s.p,{children:"The simplest way to generate SSH keys is to delegate the key generation to gcloud. In order to trigger key creation, run the following command."}),"\n",(0,o.jsx)(s.admonition,{type:"note",children:(0,o.jsx)(s.p,{children:"Ignore the result of this command. It will most likely print errors to the output console."})}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"gcloud compute ssh bastion-vm\n"})}),"\n",(0,o.jsxs)(s.p,{children:["You will be prompted to enter an SSH passphrase. This is optional, however it is recommended for additional user security.\n",(0,o.jsx)(s.img,{alt:"Getting into Bastion",src:n(3959).A+"",width:"1152",height:"816"})]}),"\n",(0,o.jsx)(s.p,{children:"The above command should log you into the bastion VM. You will see a prompt like:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"-bash-4.4$\u201d\n"})}),"\n",(0,o.jsx)(s.p,{children:"Before proceeding, exit back to your local machine"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"exit\n"})}),"\n",(0,o.jsxs)(s.p,{children:["Then make sure the above step created two keys in your ssh home directory (",(0,o.jsx)(s.code,{children:"~/.ssh"}),") as shown below:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"ls ~/.ssh\n"})}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.img,{alt:"List ssh keys",src:n(5643).A+"",width:"1104",height:"152"})}),"\n",(0,o.jsx)(s.p,{children:"Start the ssh-agent on your local machine"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"eval `ssh-agent -s`\n"})}),"\n",(0,o.jsx)(s.p,{children:"Add the google_compute_engine key to your ssh session"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"ssh-add ~/.ssh/google_compute_engine\n"})}),"\n",(0,o.jsx)(s.p,{children:"Connect to the instance with gcloud using the \u2013ssh-flag-\u201d-A\u201d flag"}),"\n",(0,o.jsx)(s.admonition,{type:"note",children:(0,o.jsx)(s.p,{children:"This command uses the default project and zone set above."})}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:'gcloud compute ssh bastion-vm --ssh-flag="-A"  --tunnel-through-iap\n'})}),"\n",(0,o.jsx)(s.h3,{id:"add-ssh-key-to-session",children:"Add SSH key to session"}),"\n",(0,o.jsxs)(s.p,{children:["Run the following command to add the google_compute_engine key to the current session",":ssh"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"ssh-add -L\n"})}),"\n",(0,o.jsx)(s.p,{children:"Connect to the workstation-vm"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"ssh 10.0.0.2\n"})}),"\n",(0,o.jsx)(s.h3,{id:"future-logins",children:"Future logins"}),"\n",(0,o.jsx)(s.p,{children:"After the initial login, you will not need to regenerate the SSH keys, but you will need the rest of the command sequence from \u201cStart the SSH agent\u201d. On your local machine:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:'eval `ssh-agent -s`\nssh-add ~/.ssh/google_compute_engine \ngcloud compute ssh bastion-vm --ssh-flag="-A" --tunnel-through-iap --project=PROJECT_ID\n'})}),"\n",(0,o.jsx)(s.p,{children:"And then on the bastion VM:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sh",children:"ssh 10.0.0.2\n"})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},2077:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/bastion_instance-3176a007f4d8db85a8eea0b9158a1e74.png"},3959:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/getting_into_bastion-b09a6a901e11b36b7c0c856663430244.png"},5643:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/ls_dot_ssh-369c9555275bc7c66cfba19ce1866ec9.png"},7685:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/select_project-2d3445b242dce0d4ca53bb0e52f1d286.png"},3190:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/ssh_in_browser-38c37a9dd011d80c26e8e781a0693058.png"},3090:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/vpc_basics-bcca2bf1a5dcd1495402c39f74bf1801.png"},385:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>a});var t=n(758);const o={},i=t.createContext(o);function r(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);